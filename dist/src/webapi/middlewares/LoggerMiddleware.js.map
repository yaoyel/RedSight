{"version":3,"file":"LoggerMiddleware.js","sourceRoot":"","sources":["../../../../src/webapi/middlewares/LoggerMiddleware.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,6DAAuE;AACvE,gDAA2C;AAG3C,IAAa,gBAAgB,GAA7B;IACI,YAA6B,QAAgB;QAAhB,aAAQ,GAAR,QAAQ,CAAQ;IAC7C,CAAC;IAEK,GAAG,CAAC,OAAY,EAAE,IAAiC;;YACrD,MAAM,KAAK,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YACzB,MAAM,IAAI,EAAE,CAAC;YACb,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC;YAC9B,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;YAClC,MAAM,OAAO,GAAG;gBACZ,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,GAAG;gBACpB,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,MAAM;gBAC1B,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,KAAK;gBACxB,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,IAAI;gBACtB,GAAG,EAAE,OAAO,CAAC,IAAI;gBACjB,KAAK,EAAE,EAAE;gBACT,IAAI,EAAE,IAAI;gBACV,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU;aACjC,CAAA;YAED,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAChC,CAAC;KAAA;CACJ,CAAA;AAtBY,gBAAgB;IAD5B,gCAAU,CAAC,EAAC,IAAI,EAAE,QAAQ,EAAC,CAAC;qCAEc,eAAM;GADpC,gBAAgB,CAsB5B;AAtBY,4CAAgB","sourcesContent":["import {KoaMiddlewareInterface, Middleware} from \"routing-controllers\";\nimport {Logger} from \"../../common/Logger\";\n\n@Middleware({type: \"before\"})\nexport class LoggerMiddleware implements KoaMiddlewareInterface {\n    constructor(private readonly m_logger: Logger) {\n    }\n\n    async use(context: any, next: (err?: any) => Promise<any>): Promise<any> {\n        const start = Date.now();\n        await next();\n        const ms = Date.now() - start;\n        context.set(\"ResTime\", `${ms}ms`);\n        const payload = {\n            url: context.req.url,\n            method: context.req.method,\n            query: context.req.query,\n            body: context.req.body,\n            res: context.body,\n            times: ms,\n            user: \"xx\", // todo,\n            status: context.res.statusCode\n        }\n\n        this.m_logger.info(payload);\n    }\n}"]}