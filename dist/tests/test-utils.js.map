{"version":3,"file":"test-utils.js","sourceRoot":"","sources":["../../tests/test-utils.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,uCAAuC;AAEvC,6DAAoD;AAEpD,wCAA4C;AAE5C,MAAM,WAAW,GAAW,IAAI,CAAC;AAIjC,qBAAkC,QAA4B;;QAC1D,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;YAAC,MAAM,CAAC;QAEtB,IAAI,GAAG,GAAQ,qCAAe,CAAC,oBAAa,EAAE,CAAC,CAAC;QAChD,IAAI,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;QACrC,IAAI,CAAC;YACD,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE,GAAG;gBAClB,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACvB,CAAC,CAAC,CAAC;YAEH,IAAI,OAAO,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC;YAChC,QAAQ,CAAC,OAAO,CAAC,CAAC;QACtB,CAAC;gBAAS,CAAC;YACP,MAAM,MAAM,CAAC,KAAK,EAAE,CAAC;QACzB,CAAC;IACL,CAAC;CAAA;AAfD,kCAeC","sourcesContent":["import * as supertest from \"supertest\";\nimport * as Koa from \"koa\";\nimport {createKoaServer} from \"routing-controllers\";\n\nimport {getKoaOptions} from \"./../src/core\";\n\nconst SERVER_PORT: number = 3100;\n\nexport type TSupertestCallback = (request: supertest.SuperTest<supertest.Test>) => void;\n\nexport async function testRequest(callback: TSupertestCallback) {\n    if (!callback) return;\n\n    let app: Koa = createKoaServer(getKoaOptions());\n    let server = app.listen(SERVER_PORT);\n    try {\n        server.on(\"error\", err => {\n            console.error(err);\n        });\n\n        let request = supertest(server);\n        callback(request);\n    } finally {\n        await server.close();\n    }\n}"]}